Version =20
VersionRequired =20
PublishOption =1
Checksum =-23326154
Begin Form
    RecordSelectors = NotDefault
    AutoCenter = NotDefault
    NavigationButtons = NotDefault
    DividingLines = NotDefault
    AllowAdditions = NotDefault
    AllowDesignChanges = NotDefault
    DefaultView =2
    ScrollBars =2
    ViewsAllowed =2
    TabularCharSet =186
    PictureAlignment =2
    DatasheetGridlinesBehavior =3
    GridX =24
    GridY =24
    Width =9405
    DatasheetFontHeight =11
    ItemSuffix =39
    DatasheetForeColor =-2147483640
    DatasheetBackColor =-2147483643
    DatasheetGridlinesColor =-2147483632
    Tag ="SubForm~Variation=Datasheet"
    RecSrcDt = Begin
        0x7c567123580ae340
    End
    GUID = Begin
        0x87d1cb60fc3b1444a60bfad5c871ae7d
    End
    NameMap = Begin
        0x0acc0e5500000000aedf26a23d768c4d96df7cc61c09179500000000409e0e62 ,
        0x580ae34040000000010000005000750072006300680061007300650020004400 ,
        0x65007400610069006c007300200045007800740065006e006400650064000000 ,
        0x00000000828ea1fa12c87946873d82f17dd46fd507000000aedf26a23d768c4d ,
        0x96df7cc61c0917955100750061006e0074006900740079000000000000001603 ,
        0x2113d24bca4da699570e475afdcc07000000aedf26a23d768c4d96df7cc61c09 ,
        0x1795440061007400650020005200650063006500690076006500640000000000 ,
        0x0000da11ebfc1c8b6948a13065ac27cdfa9907000000aedf26a23d768c4d96df ,
        0x7cc61c09179550006f007300740065006400200054006f00200049006e007600 ,
        0x65006e0074006f0072007900000000000000fa0a7d42e508b147af030cf6724e ,
        0x67e407000000aedf26a23d768c4d96df7cc61c091795500072006f0064007500 ,
        0x6300740020004e0061006d0065000000000000003fbb2defb9f4b44ca4dc7722 ,
        0xdef8efab0100000029253f64580ae3400000000000000000500072006f006400 ,
        0x7500630074002000440065007400610069006c00730000000000000000000000 ,
        0x0000000000000000000000000c00000004000000000000000000000000000000 ,
        0x0000
    End
    RecordSource ="Purchase Details Extended"
    OnCurrent ="[Event Procedure]"
    DatasheetFontName ="Calibri"
    PrtMip = Begin
        0xd002000068010000d00200006801000000000000201c0000e010000001000000 ,
        0x010000006801000000000000a10700000100000001000000
    End
    PrtDevMode = Begin
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x010402059c008007032f000001000100ea0a6f08640001000100580202000200 ,
        0x5802030001004c65747465720000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000010000000000000001000000 ,
        0x0200000001000000000000000000000000000000000000000000000050524956 ,
        0xe230000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000180000000000102710271027 ,
        0x0000102700000000000000000000c40200000000000000000000000000000000 ,
        0x00000000000000000300000000000000bc0410005c4b03006843040000000000 ,
        0x00000000010001000000000000000000000000000000000018c232e10a000000 ,
        0x01000000ff00ff00000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0xbc04000039585258020000004d4f435800000000000000000000000000000000 ,
        0x00000000000000000000000000000000440000001601000000001703d0010000 ,
        0x1803e80100001c026f0800001d02ea0a00001b01000000001201000000000101 ,
        0x010000007801010000006c0101000000b3010000000065010000000077030002 ,
        0x00009101010000006901000000006a01150000007f01000000006f0102000000 ,
        0x7001000000007101010000007201010000009201000000009301000000009401 ,
        0x01000000660100000000970100000000a10100000000980100000000a2010000 ,
        0x0000990100000000a30100000000960101000000a00101000000d1026f080000 ,
        0xd202ea0a0000db0100000000e1026f080000e202ea0a0000e30100000000ea03 ,
        0x1a020000eb035c020000d6039e020000d703e0020000ba0322030000bb036403 ,
        0x0000ce0205000000d002050000001901010000006b01030000006d0100000000 ,
        0x0d01000000008901000000001401000000001501000000000201000000000301 ,
        0x000000000401020000000f01000000001101000000001001000000008c010000 ,
        0x00008a01000000008b01000000007a03a60300007c02000000007d0200000000 ,
        0x2011000000003311000000001400000030000000000000000000000000000000 ,
        0x0000000014000000300000000000000000000000000000000000000016000000 ,
        0x000000000000000000000000000000000000000000003e000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000003e00000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000003e0000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x000000000000000000000000000000000000000000000000000000003e000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000003e00 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x3e00000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000160100000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000000000000000 ,
        0x00000000000000000000000000000000000000000000000000000000
    End
    PrtDevNames = Begin
        0x080023003a000100000000000000000000000000000000000000000000000000 ,
        0x0000000000000000000000000000000000000000000000000000787278303030 ,
        0x30616136616230333700
    End
    OnLoad ="[Event Procedure]"
    AllowFormView =0
    AllowPivotTableView =0
    AllowPivotChartView =0
    AllowPivotChartView =0
    FilterOnLoad =0
    DatasheetBackColor12 =16777215
    ShowPageMargins =0
    DisplayOnSharePointSite =0
    DatasheetAlternateBackColor =-2147483610
    DatasheetGridlinesColor12 =-1
    DatasheetForeColor12 =-2147483640
    Begin
        Begin Label
            BackStyle =0
            FontSize =9
            ForeColor =-2147483615
            FontName ="Segoe UI"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Rectangle
            SpecialEffect =3
            BackStyle =0
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CommandButton
            FontSize =9
            FontWeight =400
            ForeColor =-2147483615
            FontName ="Segoe UI"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionButton
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin CheckBox
            SpecialEffect =2
            LabelX =230
            LabelY =-30
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin OptionGroup
            SpecialEffect =3
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin BoundObjectFrame
            AddColon = NotDefault
            SpecialEffect =2
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin TextBox
            AddColon = NotDefault
            FELineBreak = NotDefault
            SpecialEffect =2
            TextFontCharSet =186
            FontSize =11
            FontName ="Calibri"
            AsianLineBreak =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            ShowDatePicker =1
        End
        Begin ListBox
            AddColon = NotDefault
            SpecialEffect =2
            TextFontCharSet =186
            FontSize =11
            BackColor =-2147483643
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ComboBox
            AddColon = NotDefault
            SpecialEffect =2
            TextFontCharSet =186
            FontSize =11
            FontName ="Calibri"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Subform
            AddColon = NotDefault
            BorderColor =-2147483609
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin UnboundObjectFrame
            SpecialEffect =2
            OldBorderStyle =1
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin ToggleButton
            FontSize =9
            FontWeight =400
            ForeColor =-2147483630
            FontName ="Segoe UI"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Tab
            FontSize =9
            FontName ="Segoe UI"
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
        End
        Begin Attachment
            BackStyle =0
            OldBorderStyle =0
            PictureSizeMode =3
            Width =4800
            Height =3840
            LeftPadding =30
            TopPadding =30
            RightPadding =30
            BottomPadding =30
            GridlineStyleLeft =0
            GridlineStyleTop =0
            GridlineStyleRight =0
            GridlineStyleBottom =0
            GridlineWidthLeft =1
            GridlineWidthTop =1
            GridlineWidthRight =1
            GridlineWidthBottom =1
            LabelX =-1800
            AddColon =0
        End
        Begin FormHeader
            Height =0
            BackColor =-2147483613
            Name ="FormHeader"
            GUID = Begin
                0x499ccf1e744e22409a3a267c2cd1cd6a
            End
        End
        Begin Section
            Height =1860
            BackColor =-2147483613
            Name ="Detail"
            GUID = Begin
                0x39ee2fadcb235a4db0c00de0e51e8c16
            End
            Begin
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =93
                    IMESentenceMode =3
                    Left =1920
                    Top =555
                    Width =3840
                    Height =360
                    ColumnWidth =1200
                    TabIndex =1
                    BackColor =-2147483643
                    Name ="Quantity"
                    ControlSource ="Quantity"
                    GUID = Begin
                        0x7ea97bf5db333648b36478231c7c5b80
                    End
                    RowGroup =2
                    GroupTable =6
                    TopPadding =0
                    BottomPadding =0
                    IMEMode =0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =300
                            Top =555
                            Width =1560
                            Height =360
                            FontSize =10
                            LeftMargin =45
                            TopMargin =45
                            RightMargin =45
                            BottomMargin =45
                            BackColor =-2147483613
                            Name ="Quantity_Label"
                            Caption ="Qty"
                            GUID = Begin
                                0xf8ff92497ad00242804d8b4926fc8197
                            End
                            RowGroup =2
                            GroupTable =6
                            TopPadding =0
                            BottomPadding =0
                            GridlineColor =-2147483609
                        End
                    End
                End
                Begin TextBox
                    OverlapFlags =95
                    IMEMode =2
                    IMESentenceMode =3
                    Left =1920
                    Top =930
                    Width =3840
                    Height =360
                    ColumnWidth =1710
                    TabIndex =2
                    BackColor =-2147483643
                    Name ="Date Received"
                    ControlSource ="Date Received"
                    Format ="Short Date"
                    AfterUpdate ="[Event Procedure]"
                    Tag ="Ignore"
                    EventProcPrefix ="Date_Received"
                    GUID = Begin
                        0x936029993f946b41bdda501076ff2307
                    End
                    RowGroup =3
                    GroupTable =6
                    TopPadding =0
                    BottomPadding =0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =300
                            Top =930
                            Width =1560
                            Height =360
                            FontSize =10
                            LeftMargin =45
                            TopMargin =45
                            RightMargin =45
                            BottomMargin =45
                            BackColor =-2147483613
                            Name ="Date Received_Label"
                            Caption ="Date Received"
                            Tag =";RegenerateCaption;"
                            EventProcPrefix ="Date_Received_Label"
                            GUID = Begin
                                0x396155b50fad7c42a55993b460cf78bb
                            End
                            RowGroup =3
                            GroupTable =6
                            TopPadding =0
                            BottomPadding =0
                            GridlineColor =-2147483609
                        End
                    End
                End
                Begin CheckBox
                    OverlapFlags =87
                    Left =1920
                    Top =1298
                    Width =3840
                    Height =360
                    ColumnWidth =2145
                    TabIndex =3
                    Name ="Posted To Inventory"
                    ControlSource ="Posted To Inventory"
                    AfterUpdate ="[Event Procedure]"
                    EventProcPrefix ="Posted_To_Inventory"
                    GUID = Begin
                        0xacae2def7424c34d9dc42c01cf11dab2
                    End
                    RowGroup =4
                    GroupTable =6
                    TopPadding =0
                    BottomPadding =0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =300
                            Top =1298
                            Width =1560
                            Height =360
                            FontSize =10
                            LeftMargin =45
                            TopMargin =45
                            RightMargin =45
                            BottomMargin =45
                            BackColor =-2147483613
                            Name ="Posted To Inventory_Label"
                            Caption ="Add to Inventory"
                            EventProcPrefix ="Posted_To_Inventory_Label"
                            GUID = Begin
                                0x3b89830b74b2ce43a945a808560389ac
                            End
                            RowGroup =4
                            GroupTable =6
                            TopPadding =0
                            BottomPadding =0
                            GridlineColor =-2147483609
                        End
                    End
                End
                Begin TextBox
                    Locked = NotDefault
                    OverlapFlags =87
                    Left =1920
                    Top =180
                    Width =3840
                    Height =360
                    ColumnWidth =4200
                    BackColor =-2147483643
                    Name ="Product Name"
                    ControlSource ="Product Name"
                    StatusBarText ="Double-click to go to details"
                    Tag ="DrillToRelated~FormName=Product Details~DestID=ID"
                    EventProcPrefix ="Product_Name"
                    GUID = Begin
                        0x1001b19bf88fab4b8703f16ea0cf4cd5
                    End
                    RowGroup =1
                    GroupTable =6
                    TopPadding =0
                    BottomPadding =0
                    OnDblClickEmMacro = Begin
                        Version =196611
                        ColumnsShown =10
                        Begin
                            Condition ="IsNull([Screen].[ActiveControl])"
                            Action ="StopMacro"
                        End
                        Begin
                        End
                        Begin
                            Action ="OpenForm"
                            Argument ="Product Details"
                            Argument ="0"
                            Argument =""
                            Argument ="=\"[ID]=\" & [Screen].[ActiveControl]"
                            Argument ="-1"
                            Argument ="3"
                        End
                        Begin
                            Action ="OnError"
                            Argument ="0"
                        End
                        Begin
                            Action ="Requery"
                            Argument ="=[Screen].[ActiveControl].[Name]"
                        End
                    End
                    OnGotFocusEmMacro = Begin
                        Version =196611
                        ColumnsShown =10
                        Begin
                            Action ="OnError"
                            Argument ="0"
                        End
                        Begin
                            Condition ="[Screen].[ActiveForm].[Name]=[Form].[Name]"
                            Action ="Requery"
                            Argument ="=[Screen].[ActiveControl].[Name]"
                        End
                    End
                    IMEMode =0
                    Begin
                        Begin Label
                            OverlapFlags =85
                            Left =300
                            Top =180
                            Width =1560
                            Height =360
                            FontSize =10
                            LeftMargin =45
                            TopMargin =45
                            RightMargin =45
                            BottomMargin =45
                            BackColor =-2147483613
                            Name ="Product Name_Label"
                            Caption ="Product"
                            EventProcPrefix ="Product_Name_Label"
                            GUID = Begin
                                0x51140da36c2b0a46a75affdd9dc0b7ff
                            End
                            RowGroup =1
                            GroupTable =6
                            TopPadding =0
                            BottomPadding =0
                            GridlineColor =-2147483609
                        End
                    End
                End
            End
        End
        Begin FormFooter
            Height =0
            BackColor =-2147483613
            Name ="FormFooter"
            GUID = Begin
                0xd67e6e9674367f478eaf3395ad335b05
            End
        End
    End
End
CodeBehindForm
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = True
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Compare Database
Option Explicit


Private Sub Posted_To_Inventory_AfterUpdate()
    On Error GoTo ErrorHandler

    Dim InventoryID As Long
    Dim ProductID As Long
    Dim Quantity As Long
    
    ProductID = Nz(Me![Product ID], 0)
    Quantity = Nz(Me![Quantity], 0)
    InventoryID = Nz(Me![Inventory ID], 0)
    
    'Posting New Inventory
    If Me![Posted To Inventory] Then
        If IsNull(Me![Date Received]) Then
            Me![Date Received] = Date
        End If
        
        If Inventory.AddPurchase(Me![Purchase Order ID], ProductID, Quantity, InventoryID) Then
            If InventoryID > 0 Then
                Me![Inventory ID] = InventoryID
                Me![Posted To Inventory] = True
                MsgBoxOKOnly InventoryPostingSuccess
            End If
        Else
            Me![Posted To Inventory] = False
            MsgBoxOKOnly InventoryPostingFailure
        End If
        
        eh.TryToSaveRecord
        
        If Inventory.GetQtyOnBackOrder(ProductID) > 0 Then
            If MsgBoxYesNo(FillBackOrdersPrompt) Then
                Inventory.FillBackOrders ProductID
            End If
        End If
        
    'Removing Posted Inventory
    Else
        If InventoryID > 0 Then
            Me![Posted To Inventory] = True
        End If
    End If
    
Done:
    Exit Sub

ErrorHandler:
    ' Resume statement will be hit when debugging
    If eh.LogError("Posted_To_Inventory_AfterUpdate") Then Resume
End Sub


Private Sub Date_Received_AfterUpdate()
    If Me![Posted To Inventory] Then
        Debug.Assert False
    ElseIf MsgBoxYesNo(PostReceivedProductPrompt) Then
        Me![Posted To Inventory] = True
        Posted_To_Inventory_AfterUpdate
    End If
End Sub


Private Sub Form_Current()
    Me.AllowEdits = Not Me![Posted To Inventory]
End Sub


Private Sub Form_Load()
    Dim rsw As New RecordsetWrapper
    With rsw.GetRecordsetClone(Me.Recordset)
        'Ensure integrity of Inventory postings
        While Not .EOF
            If Not IsNull(![Inventory ID]) Then
                rsw.Edit
                ![Posted To Inventory] = True
                rsw.Update
            End If
            rsw.MoveNext
        Wend
    End With
End Sub
